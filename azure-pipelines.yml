trigger:
- main  # Cambia 'main' por el nombre de tu rama principal si es diferente

pool:
  vmImage: 'ubuntu-latest'  # Usamos una imagen Ubuntu para construir el contenedor

steps:
- script: |
    echo "Build.SourcesDirectory: $(Build.SourcesDirectory)"
    ls -la $(Build.SourcesDirectory)  # Verificar que el Dockerfile y los archivos estén presentes
  displayName: 'Verificar Build.SourcesDirectory y archivos'

- task: Checkout@1  # Asegúrate de que esto esté al principio

- task: Docker@2
  displayName: 'Build y push de la imagen'
  inputs:
    containerRegistry: 'dockerhub'  # Nombre de la conexión de servicio a Docker Hub
    command: 'buildAndPush'
    Dockerfile: '$(Build.SourcesDirectory)/Dockerfile'  # Ruta al Dockerfile
    tags: 'latest'  # Etiqueta para la imagen
    buildContext: '$(Build.SourcesDirectory)'  # Ruta de los archivos fuente
    repository: 'jvicmar95/azuredevops'  # Tu repositorio de Docker Hub
